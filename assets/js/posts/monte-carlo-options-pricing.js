function update(){({data:data,layout:layout}=simulate()),Plotly.animate("plot-0",{data:[data],layout:layout},config)}function generate(){var a=[],e=[];const t=params.N,l=params.S0,r=params.K,n=.05,s=.2,i=100;for(var o=[],u=[];u.length<100;){do{var d=Math.floor(1e6*Math.random()+1)}while(u.indexOf(d)>=0);u.push("#"+("000000"+d.toString(16)).slice(-6))}var m=1e4,g=-1;for(let d=0;d<t;d++){for(let t=0;t<i;t++){let i=gaussian();a[t]=t,S_t=l*Math.exp(t/365*(n-.5*s*s)+s*Math.sqrt(t/365)*i),e[t]=S_t-r,m=Math.min(m,e[t]),g=Math.max(g,e[t])}var c={x:a,y:e.map(a=>a+l),mode:"line",line:{color:u[d],simplify:!1}};o.push(c)}return layout.yaxis.range=[50,150],o}function simulate(){var a=[],e=[],t=-1,l=1e4;const r=params.S0,n=(params.K,meanSlider.value),s=sigmaSlider.value,i=daysSlider.value;for(let o=0;o<i;o++){let i=gaussian();a[o]=o,e[o]=r*Math.exp(o/365*(n-.5*s*s)+s*Math.sqrt(o/365)*i),t=Math.max(t,e[o]),l=Math.min(l,e[o])}const o=.1*(t-l);return{data:{x:a,y:e,mode:"line",line:{color:"blue",simplify:!1}},layout:layout={showlegend:!1,autosize:!0,hovermode:!1,paper_bgcolor:"rgba(0,0,0,0)",plot_bgcolor:"rgba(0,0,0,0)",yaxis:{range:[l-o,t+o]}}}}function gaussian(){let a=0,e=0;for(;0===a;)a=Math.random();for(;0===e;)e=Math.random();return Math.sqrt(-2*Math.log(a))*Math.cos(2*Math.PI*e)}var params={S0:100,K:100,r:.15,sigma:.05,T:100,N:100},layout={showlegend:!1,autosize:!0,hovermode:!1,paper_bgcolor:"rgba(0,0,0,0)",plot_bgcolor:"rgba(0,0,0,0)"};const config={displayModeBar:!1,transition:{duration:500,easing:"cubic-in-out"},frame:{duration:500},responsive:!0,staticPlot:!1};var meanSlider,meanValue,sigmaSlider,sigmaValue,daysSlider,daysValue;meanSlider=document.getElementById("mean-slider"),meanValue=document.getElementById("mean-slider-value"),sigmaSlider=document.getElementById("sigma-slider"),sigmaValue=document.getElementById("sigma-slider-value"),daysSlider=document.getElementById("days-slider"),daysValue=document.getElementById("days-slider-value"),tracesSlider=document.getElementById("traces-slider"),tracesValue=document.getElementById("traces-slider-value"),meanSlider.value=params.r,sigmaSlider.value=params.sigma,daysSlider.value=params.T,tracesSlider.value=params.N,meanValue.innerHTML=Math.round(100*meanSlider.valueAsNumber)+"%",sigmaValue.innerHTML=Math.round(100*sigmaSlider.valueAsNumber)+"%",daysValue.innerHTML=daysSlider.value,tracesValue.innerHTML=tracesSlider.value,({data:data,layout:layout}=simulate());var generateData=generate();Plotly.newPlot("plot-0",{data:[data],layout:layout},config),Plotly.newPlot("plot-1",{data:generateData,layout:layout},config),meanSlider.onchange=function(){meanValue.innerHTML=Math.round(100*this.valueAsNumber)+"%",params.r=this.valueAsNumber,update()},sigmaSlider.onchange=function(){sigmaValue.innerHTML=Math.round(100*this.valueAsNumber)+"%",params.sigma=this.valueAsNumber,update()},daysSlider.onchange=function(){daysValue.innerHTML=Math.round(this.valueAsNumber),params.T=this.valueAsNumber,update()},tracesSlider.onchange=function(){tracesValue.innerHTML=Math.round(this.valueAsNumber),params.N=this.valueAsNumber,generateData=generate(),Plotly.newPlot("plot-1",{data:generateData,layout:layout},config)};